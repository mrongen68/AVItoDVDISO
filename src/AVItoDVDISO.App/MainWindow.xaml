<Window x:Class="AVItoDVDISO.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AVItoDVDISO.App"
        mc:Ignorable="d"
        Title="AVI to DVD ISO" Height="720" Width="1020"
        WindowStartupLocation="CenterScreen">
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="220"/>
    </Grid.RowDefinitions>

    <TextBlock Grid.Row="0" FontSize="20" Text="AVI to DVD ISO" Margin="0,0,0,8"/>

    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <GroupBox Header="Source files" Grid.Column="0" Margin="0,0,10,0">
        <Grid Margin="8">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>

          <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
            <Button Content="Add" Width="90" Margin="0,0,8,0" Click="Add_Click"/>
            <Button Content="Remove" Width="90" Margin="0,0,8,0" Click="Remove_Click"/>
            <Button Content="Up" Width="60" Margin="0,0,8,0" Click="Up_Click"/>
            <Button Content="Down" Width="60" Click="Down_Click"/>
            <TextBlock Text="{Binding TotalDurationText}" Margin="16,4,0,0"/>
          </StackPanel>

          <ListView Grid.Row="1" ItemsSource="{Binding Sources}" SelectedItem="{Binding SelectedSource}">
            <ListView.View>
              <GridView>
                <GridViewColumn Header="File" DisplayMemberBinding="{Binding FileName}" Width="360"/>
                <GridViewColumn Header="Duration" DisplayMemberBinding="{Binding Duration}" Width="120"/>
                <GridViewColumn Header="WxH" Width="100">
                  <GridViewColumn.CellTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding VideoWidth}"/>
                    </DataTemplate>
                  </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="FPS" DisplayMemberBinding="{Binding Fps}" Width="80"/>
              </GridView>
            </ListView.View>
          </ListView>

          <TextBlock Grid.Row="2" Foreground="Gray" Margin="0,8,0,0"
                     Text="Tools must exist in the tools folder next to the exe: ffmpeg, ffprobe, dvdauthor, xorriso."/>
        </Grid>
      </GroupBox>

      <GroupBox Header="DVD settings" Grid.Column="1">
        <Grid Margin="8">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <TextBlock Grid.Row="0" Grid.Column="0" Text="Mode" Margin="0,0,10,10" VerticalAlignment="Center"/>
          <ComboBox Grid.Row="0" Grid.Column="1" Margin="0,0,0,10"
                    ItemsSource="{Binding DvdModes}" SelectedItem="{Binding SelectedDvdMode}"/>

          <TextBlock Grid.Row="1" Grid.Column="0" Text="Aspect" Margin="0,0,10,10" VerticalAlignment="Center"/>
          <ComboBox Grid.Row="1" Grid.Column="1" Margin="0,0,0,10"
                    ItemsSource="{Binding AspectModes}" SelectedItem="{Binding SelectedAspectMode}"/>

          <TextBlock Grid.Row="2" Grid.Column="0" Text="Preset" Margin="0,0,10,10" VerticalAlignment="Center"/>
          <ComboBox Grid.Row="2" Grid.Column="1" Margin="0,0,0,10"
                    ItemsSource="{Binding Presets}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedPreset}"/>

          <TextBlock Grid.Row="3" Grid.Column="0" Text="Chapters" Margin="0,0,10,10" VerticalAlignment="Center"/>
          <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,10">
            <CheckBox Content="Every" IsChecked="{Binding ChaptersEnabled}" Margin="0,2,8,0"/>
            <TextBox Width="50" Text="{Binding ChaptersMinutes}" IsEnabled="{Binding ChaptersEnabled}" Margin="0,0,6,0"/>
            <TextBlock Text="minutes" VerticalAlignment="Center" Opacity="0.8"/>
          </StackPanel>

          <Separator Grid.Row="4" Grid.ColumnSpan="2" Margin="0,6,0,10"/>

          <TextBlock Grid.Row="5" Grid.Column="0" Text="Output" Margin="0,0,10,10" VerticalAlignment="Center"/>
          <StackPanel Grid.Row="5" Grid.Column="1" Margin="0,0,0,10">
            <CheckBox Content="DVD folder (VIDEO_TS)" IsChecked="{Binding ExportFolder}"/>
            <CheckBox Content="ISO image" IsChecked="{Binding ExportIso}"/>
          </StackPanel>

          <StackPanel Grid.Row="6" Grid.ColumnSpan="2">
            <TextBlock Text="Output folder" Margin="0,0,0,6"/>
            <DockPanel>
              <TextBox Text="{Binding OutputPath}" MinWidth="240" Margin="0,0,8,0"/>
              <Button Content="Browse" Width="90" Click="Browse_Click"/>
            </DockPanel>

            <TextBlock Text="Disc label" Margin="0,10,0,6"/>
            <TextBox Text="{Binding DiscLabel}" MaxLength="32"/>

            <StackPanel Orientation="Horizontal" Margin="0,14,0,0">
              <Button Content="Convert" Width="120" Margin="0,0,8,0" Click="Convert_Click" IsEnabled="{Binding CanConvert}"/>
              <Button Content="Cancel" Width="120" Click="Cancel_Click" IsEnabled="{Binding IsRunning}"/>
              <TextBlock Text="{Binding StatusText}" Margin="12,6,0,0"/>
            </StackPanel>

            <ProgressBar Height="18" Margin="0,10,0,0" Minimum="0" Maximum="100" Value="{Binding OverallProgress}"/>
          </StackPanel>
        </Grid>
      </GroupBox>
    </Grid>

    <Grid Grid.Row="2" Margin="0,10,0,10">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>

      <TextBlock Grid.Column="0" Text="Working folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
      <TextBlock Grid.Column="1" Text="{Binding WorkingDir}" VerticalAlignment="Center" Opacity="0.8"/>
      <Button Grid.Column="2" Content="Open output" Width="120" Click="OpenOutput_Click"/>
    </Grid>

    <GroupBox Grid.Row="3" Header="Log">
      <TextBox Margin="8" Text="{Binding LogText}" IsReadOnly="True" VerticalScrollBarVisibility="Auto" TextWrapping="NoWrap"/>
    </GroupBox>
  </Grid>

</Window>
